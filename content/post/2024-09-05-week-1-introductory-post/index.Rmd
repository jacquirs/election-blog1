---
title: 'Week 1: Introduction and Past National Election Data'
author: Jacqui Schlesinger
date: '2024-09-05'
slug: week-1-introductory-post
categories: []
tags: []
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
```

```{r, results = 'hide'}
# Load libraries
library(ggplot2)
library(maps)
library(tidyverse)
library(plotly)
library(ggrepel)

```

```{r}
####----------------------------------------------------------#
#### Data read in and cleaning
####----------------------------------------------------------#

### Popular vote data
# Read presidential popular vote
d_popvote <- read_csv("C:/Users/Jacqui Schlesinger/Documents/election-blog1/popvote_1948-2020.csv") # if you run this code please change to location of data

# Pivot data to wide format with party names as columns and two-party vote share as values.
d_popvote_wide <- d_popvote |>
    select(year, party, pv2p) |>
    pivot_wider(names_from = party, values_from = pv2p)

# Modify winner column to show "D" if Democrats win and "R" if Republicans win
d_popvote_wide <- d_popvote_wide |> 
    mutate(winner = case_when(democrat > republican ~ "D",
                              TRUE ~ "R"))

### Shape file data
# Sequester shapefile of states from `maps` library
states_map <- map_data("state")

### Candidate votes wide data
# Read wide version of dataset that can be used to compare candidate votes with one another
d_pvstate_wide <- read_csv("C:/Users/Jacqui Schlesinger/Documents/election-blog1/clean_wide_state_2pv_1948_2020.csv") # if you run this code please change to location of data to fit your set up

# Merge d_pvstate_wide with state_map
d_pvstate_wide$region <- tolower(d_pvstate_wide$state)

pv_map <- d_pvstate_wide |>
  left_join(states_map, by = "region")

### Electoral votes data by state and year
ec <- read_csv("C:/Users/Jacqui Schlesinger/Documents/election-blog1/ec_full.csv") # if you run this code please change to location of data to fit your set up

# Update to handle three years where DC electors is NA (2012, 2016, 2020)
ec <- ec %>%
  mutate(electors = ifelse(state == "District Of Columbia" & is.na(electors), 3, electors))

# note: ec dataset is missing 1960 during which the electoral votes were different than in 1956 or 1964 by state, so I have not manually entered them

### Electoral votes by year and party
# because our data does not include info about third parties, I created this csv so that a line plot of electoral college votes will be appropriate for graphing
ec_yearly <- read_csv("C:/Users/Jacqui Schlesinger/Documents/election-blog1/electoral_by_year.csv") # if you run this code please change to location of data to fit your set up

```

```{r}
####----------------------------------------------------------#
#### Extension 1 Partial: Create a Custom Theme
####----------------------------------------------------------#

# Create custom theme for maps 
maps_theme <- theme_bw() + 
    theme(panel.border = element_blank(),     
          panel.grid.major = element_blank(),
          panel.grid.minor = element_blank(),
          axis.title = element_blank(),
          axis.text = element_blank(),
          axis.ticks = element_blank(),
          plot.title = element_text(size = 12),
          strip.text = element_text(size = 9),
          legend.position = "right",
          legend.text = element_text(size = 8),
          legend.title = element_text(size = 9))

# Create custom theme for line plots
line_plot_theme <- theme_bw() + 
    theme(panel.border = element_blank(),
          plot.title = element_text(size = 15, hjust = 0.5), 
          axis.text.x = element_text(angle = 45, hjust = 1),
          axis.text = element_text(size = 12),
          strip.text = element_text(size = 18),
          axis.line = element_line(colour = "black"),
          legend.position = "bottom",
          legend.text = element_text(size = 12))
```

_Throughout the course of this blog, I will attempt to predict the outcome of the 2024 US presidential election. As a part of Gov 1347: Election Analytics with Professor Enos, I will use data from a variety of sources to develop a compelling model._

This week's focus is on data from national presidential election outcomes, 1948-2020. Before analyzing the factors leading to a candidate's victory, it is important to understand past election trends. The objective of this post is to answer two questions in furtherance of this goal: **(a) how competitive are presidential elections in the United States**, and **(b) which states vote blue/red and how consistently**. I will examine both electoral college and two-way popular vote results, margins, and year to year swings, as well as implement the simplified Helmut Norpoth model to provide a baseline prediction based solely on prior election results.

### Popular Vote Over Time
The national popular vote provides the percentage of all votes cast for a specific candidate. However, because of the presence of national and state-level third party candidates, it is helpful to look at a two-way popular vote percentage, which uses only total votes cast for the two main parties. 

Looking at the two-way popular vote results from 1948 to 2020, I can evaluate how the distribution of the popular vote has changed between the two parties.

```{r}
####----------------------------------------------------------#
#### Past Two Way Popular Vote Results
####----------------------------------------------------------#

# Create line plot of R and D two party national popular vote by year
popvote_line <- d_popvote %>%
  ggplot(aes(x = year, y = pv2p, color = party, group=1, text = paste("Year:", year, "<br>2-Way Popular Vote:", round(pv2p, 1), "%"))) + 
  geom_line(stat = "identity") +
  geom_point() +
  scale_color_manual(values = c("dodgerblue4","firebrick1")) +
  xlab("") +
  ylab("Two-Party National Popular Vote (%)") +
  ggtitle("Presidential Vote Share (1948-2020)") + 
  scale_x_continuous(breaks = seq(1948, 2020, 4)) +
  line_plot_theme

ggplotly(popvote_line, tooltip = "text")
```

```{r, results = 'hide'}
####----------------------------------------------------------#
#### Calcs for Paragraph
####----------------------------------------------------------#
diff_calcs <- d_popvote %>%
  group_by(year) %>%
  summarize(
    R_pv2p = pv2p[party == 'republican'],
    D_pv2p = pv2p[party == 'democrat'],
    diff = abs(R_pv2p - D_pv2p)
  ) %>%
  ungroup() %>%
  arrange(desc(diff))

diff_calcs
```

The plot reveals that neither of the two parties has consistently dominated over the last 70 years. Power shifts between Democrats and Republicans occur every few election cycles. The margins have varied significantly, with some elections resulting in large gaps between the two parties, like the 23.6 percentage-point difference in 1972 between Nixon and McGovern, and others with extremely tight races, such as the 0.17 percentage-point margin in 1960 between Nixon and Kennedy. Over the decades, these two-way popular vote margins have fluctuated, but landslide victories have seemingly become less common, with margins still fluctuating but within consistently tighter races. 

### Electoral College Results Over Time
The Electoral College also reflects the increased competitiveness seen in popular vote trends. As the true determinant of presidential election results, the Electoral College provides insight into how close the elections we observed above truly were.   

```{r}
####----------------------------------------------------------#
#### Past Electoral College Results
####----------------------------------------------------------#

# Create line plot of R and D electoral votes by year, removing other candidates
ecvote_line <- ec_yearly %>%
  filter(party != "Other") %>%
  ggplot(aes(x = year, y = electoral_votes, color = party, group=1, text = paste("Year:", year, "<br>Electors:", electoral_votes))) + 
  geom_line(stat = "identity") +
  geom_point() +
  geom_hline(yintercept = 270, linetype = "dotted", color = "yellow") +
  scale_color_manual(values = c("dodgerblue4","firebrick1")) +
  xlab("") +
  ylab("Electoral College Votes (Number of Electors)") +
  ggtitle("Presidential Electoral College Share (1948-2020)") + 
  scale_x_continuous(breaks = seq(1948, 2020, 4)) +
  line_plot_theme

ggplotly(ecvote_line, tooltip = "text")

```

```{r, results = 'hide'}
####----------------------------------------------------------#
#### Calculate background statistics
####----------------------------------------------------------#

# Summarize data with respect to winners
d_popvote_wide |> 
  group_by(winner) |>
  summarise(races = n())

```

With 270 electoral votes needed to win, Democrats have won 11 elections and Republicans 8 since 1948. The dominance of one party or the other in the Electoral College has similarly declined, with fewer landslide victories in recent years. This points to an _increased competitiveness in presidential elections_.

### Electoral College Versus Two-Way Popular Vote Share
Close elections often hinge in the Electoral College on [a few key states](https://books.google.com/books?hl=en&lr=&id=1it4EAAAQBAJ&oi=fnd&pg=PA339&dq=swing+states+became+critical+to+elections&ots=Udo10ht0-f&sig=jVlcrKHiERO7ckvIGSgCJAb4poY#v=onepage&q&f=false). Later, I will investigate the electoral and popular vote trends in swing states, responsible for determining the election outcome For now, I examine the national electoral votes and two-way popular votes since 1948, comparing the two margins of victory over the elections with the largest and smallest margins. 

Here are a few notable comparisons between popular vote margins and electoral outcomes:

_1972 (Nixon vs. McGovern)_: Nixon (R) won by margin of 23.6 percentage points and 503 electoral votes.

_1964 (Goldwater vs. Johnson)_: Johnson (D) won by margin of 22.7 percentage points and 434 electoral votes.

_1960 (Nixon vs. Kennedy)_: Kennedy (D) won by margin of 0.17 percentage points and 84 electoral votes.

_2000 (Bush vs. Gore)_: Bush (R) lost the two-way popular vote by 0.5 percentage points but won electoral college by 5 votes.

As seen in 2000 (and 2016), observed fluctuations in both electoral and popular vote results are of similar magnitude, but do not always lead to the same outcome. _These cases demonstrate how the national popular vote and Electoral College results don’t always align, underscoring the importance of state-level popular vote outcomes in predicting elections._

### Swing State and Margins Analysis, 1948-2020
To better understand how the popular vote and win margins can effect and even predict election outcomes, it’s crucial to analyze changes at the state level year-over-year. Looking at how much each state swings-- the change in the popular vote margin in each election year relative to the results in that state from the last election-- provides insight into where elections might be won or lost.

```{r}
####----------------------------------------------------------#
#### Extension 3: Swing State Map Extension
####----------------------------------------------------------#

# Calculate swing map margins for each state and year (D sub y minus D sub y-4) 
pv2p_2024_states <- d_pvstate_wide %>%
  group_by(state) %>%
  mutate(pv2p_margin = D_pv2p - D_pv2p_lag1, region = tolower(state))

# Join data with states shape file and graph swing for years 1980-2020 using facets
pv2p_2024_states %>% 
  filter(year >= 1980) %>%
  left_join(states_map, by = "region") %>%
  ggplot(aes(long, lat, group = group)) +
  geom_polygon(aes(fill = pv2p_margin), color = "black") +
  facet_wrap(facets = year ~.) + # 
  ggtitle("Change in Vote Margin From Past Election, 1980-2020") + 
  scale_fill_gradient2(
    high = "dodgerblue4",
    mid = "white",
    low = "firebrick1",
    limits = c(-15, 15),
    name = "Percentage Point Swing (pp)"
  ) +
  maps_theme

```

States with darker shades swung more in the direction of Republicans if red and Democrats if blue, relative to its marginal position the past year. Importantly, dark shading doesn’t necessarily mean a state is competitive or a swing states-- in fact, it is the opposite. 

For instance, Utah consistently votes Republican but saw a large red swing in 2012 when Mitt Romney, a native of Utah, was the GOP nominee. This greatly affected the swing in the adjacent presidential elections. In 2008, Republicans won with 62.6% of the two-way popular vote, while in 2012, Romney won with 74.6%. The state therefore swung much more red than before, but the outcome of the electoral votes did not change. But in 2016, while Trump still significantly won with 62.4% of the two-way popular vote, the margins was not as large, leading to a blue swing This does not mean Utah is a swing state, as it has not voted for a Democrat since President Johnson in 1964 during the second largest landslide victory covered above.

By contrast, states with consistently smaller swings, like Pennsylvania and Arizona, are more likely to be true swing states. It is important to look both at the swing and the actual popular vote to see which states are actually swing states. A swing map helps visualize only how much or little states are moving relatively. For example, in 2008, many states swung more Democratic than they had in the past for Obama, but by 2012, the swing shifted more red. However, Obama still won re-election, demonstrating that while swing maps show overall support changes, the popular vote within each state matters.

### The Helmut Norpoth Model
While swings and margins provide valuable information, they alone are not enough to predict election outcomes. The same goes for the popular vote outcome nationally, which does not always determine the electoral votes. But looking at state-level popular vote can provide a method for an early and simplified prediction of the 2024 election result based on past results using a simplified version of the [Helmut Northpoth electoral cycle model](http://primarymodel.com/). This simplified model is defined by 

$$ vote_{2024} = 0.75vote_{2020} + 0.25vote_{2016}$$
Using the Helmut Norpoth model, we can calculate the two-way popular vote, margins, swings, and electoral outcomes for the 2024 election. This is a predictive model of the election-- see below for evaluating its effectiveness-- using inputs of past election results to predict a future outcome.

The map generated by this model shows predicted margins of victory by state, as well as the projected winner and total electoral votes.

```{r}
####----------------------------------------------------------#
#### 2024 Margins Forecast
####----------------------------------------------------------#

# Create prediction (pv2p and margin) based on Helmut Norpoth electoral cycle model
# vote_2024 = 3/4*vote_2020 + 1/4*vote_2016 (lag1, lag2, respectively)

# Calculate 2024 pv2p and margin
pv2p_2024_states_margins <- d_pvstate_wide %>%
  filter(year == 2020) %>%
  group_by(state) %>%
  summarize(D_pv2p_2024 = 3/4 * D_pv2p + 1/4 * D_pv2p_lag1,
            R_pv2p_2024 = 3/4 * R_pv2p + 1/4 * R_pv2p_lag1) %>%
  mutate(pv2p_2024_margin = R_pv2p_2024 - D_pv2p_2024,
         region = tolower(state))

# Add electoral college votes for map labeling
pv2p_2024_states_margins <- pv2p_2024_states_margins %>%
  mutate(year = 2024,
         winner = ifelse(pv2p_2024_margin > 0, "R", "D")) %>%
  left_join(ec, by = c("state", "year"))

# Plot the projected margin of victory in 2024
base_map <- pv2p_2024_states_margins %>%
  left_join(states_map, by = "region") %>%
  ggplot(aes(long, lat, group = group)) +
  geom_polygon(aes(fill = pv2p_2024_margin,
                   text = paste("State:", state,
                                "<br>Margin:", round(abs(pv2p_2024_margin), 2),
                                "<br>Projected Winner:", winner,
                                "<br>Electoral Votes:", electors)),
               color = "black") +
  ggtitle("2024 Presidential Margins Forecast (Helmut Norpoth Electoral Cycle Model)") + 
  scale_fill_gradient2(high = "firebrick1", 
                       mid = "white", 
                       low = "dodgerblue4", 
                       breaks = c(-50, -25, 0, 25, 50),
                       limits = c(-50, 50),
                       name = "Percentage Point Margin (pp)") +
  maps_theme

# Apply plotly to get hover labels
plotly_map <- ggplotly(base_map, tooltip = "text")
plotly_map

```

States with a small projected margin of victory are consistent with the battleground states in this election: Arizona, Georgia, North Carolina, Pennsylvania, Wisconsin, Michigan, and Nevada. We can also look at the projected swing of these states compared to the 2020 election to understand which direction these states are moving in. 

```{r}
####----------------------------------------------------------#
#### Extension 3 Continued x Forecast 2024
####----------------------------------------------------------#

# Calculate 2024 pv2p, margin, swing
pv2p_2024_states_swing <- d_pvstate_wide %>%
  filter(year == 2020) %>%
  group_by(state) %>%
  mutate(D_pv2p_2024 = 3/4 * D_pv2p + 1/4 * D_pv2p_lag1,
            R_pv2p_2024 = 3/4 * R_pv2p + 1/4 * R_pv2p_lag1) %>%
  mutate(pv2p_2024_margin = R_pv2p_2024 - D_pv2p_2024,
         pv2p_2024_swing =  D_pv2p_2024 - D_pv2p,
         region = tolower(state))

# Add electoral college votes for map labeling
pv2p_2024_states_swing <- pv2p_2024_states_swing %>%
  mutate(year = 2024,
         winner = ifelse(pv2p_2024_margin > 0, "R", "D")) %>%
  left_join(ec, by = c("state", "year"))

# Plot the swing from 2020
base_map <- pv2p_2024_states_swing %>%
  left_join(states_map, by = "region") %>%
  ggplot(aes(long, lat, group = group)) +
  geom_polygon(aes(fill = pv2p_2024_swing,
                   text = paste("State:", state,
                                "<br>Swing:", round(pv2p_2024_swing, 2),
                                "<br>Margin:", round(abs(pv2p_2024_margin), 2),
                                "<br>Projected Winner:", winner,
                                "<br>Electoral Votes:", electors)),
               color = "black") +
  ggtitle("2024 Presidential Swing Forecast (Simplified Electoral Cycle Model)") + 
  scale_fill_gradient2(high = "dodgerblue4", 
                       mid = "white", 
                       low = "firebrick1", 
                       breaks = c(-2, -1, 0, 1, 2),
                       limits = c(-2, 2),
                       name = "Percentage Point Swing (pp)") +
  maps_theme

# Apply plotly to get hover labels
plotly_map <- ggplotly(base_map, tooltip = "text")
plotly_map

```

Most states are projected to swing slightly more Republican in 2024 than they did in 2020, but this doesn’t necessarily indicate a Republican victory. In fact, this Republican swing makes sense in the context of the simplified model, which relies on 75% of the 2020 results and 25% of the 2016 results in each state. In 2016, many states voted more red than they did in 2020, so just using these two to make a prediction about the election will automatically pull the 2024 forecast to be more Republican than the 2020 results.

```{r, results = 'hide'}
####----------------------------------------------------------#
#### Electoral college 2024 predication
####----------------------------------------------------------#

# calculate 2024 pv2p
pv2p_2024_states_elec <- d_pvstate_wide %>%
  filter(year == 2020) %>%
  group_by(state) %>%
  summarize(D_pv2p_2024 = 3/4 * D_pv2p + 1/4 * D_pv2p_lag1,
            R_pv2p_2024 = 3/4 * R_pv2p + 1/4 * R_pv2p_lag1) %>%
  mutate(region = tolower(state))

# figure out who wins each year, join in state electoral counts
pv2p_2024_states_elec <- pv2p_2024_states_elec %>%
  mutate(year = 2024,
         winner = ifelse(R_pv2p_2024 > D_pv2p_2024, "R", "D")) %>%
  left_join(ec, by = c("state", "year"))

# coutn electors for each party
pv2p_2024_states_elec %>%
  group_by(winner) %>%
  summarize(electoral_votes = sum(electors))

## Harris: 276
## Trump: 262
```

In fact, the model forecasts that Vice President Kamala Harris will win 276 electoral to former president Donald Trump's 262, a democratic victory. 

### Simplified Norporth Model Pitfalls and Future Forecast Additions
While the simplified Norpoth's model offers a basic prediction (in its unsimplified form it has [greater than 50% effective](http://primarymodel.com/) in its predictions), still misses many of the known drivers of voter behavior. 

A comparison to [Fair's Electoral Models](https://drive.google.com/drive/u/0/folders/1Sim1ht01NGVFkiCzcx7cOVZo97H02xKj) shows the absence of important economic fundamentals that drive voter behavior, as well as factors including incumbency and party in charge. Diving deeper, the variables in Fair's model are all economy-based, with the intercept taking into account non-economic values like past voting patterns. 

Additionally, the [impact of published forecasts](https://www-journals-uchicago-edu.ezp-prod1.hul.harvard.edu/doi/pdfplus/10.1086%2F708682) on voters and the [potential ineffectiveness of campaign on-the-ground strategy](https://www-cambridge-org.ezp-prod1.hul.harvard.edu/core/journals/american-political-science-review/article/party-activists-as-campaign-advertisers-the-ground-campaign-as-a-principalagent-problem/6117E8EF4C72A046ABFE6A8FDEDEA95E) are not considered here. 

In future forecasts, I will explore these and other factors that are known to influence elections. For now, the simplified Norpoth model provides a basic prediction of the 2024 election outcome.

**Current Forecast: Harris 276 - Trump 262**

### Data Sources
- Popular vote and two-way vote by candidate, 1948-2020
- Popular vote and two-way vote by state, 1948-2020
- Electoral College by state, 1948-2020

_Note for Gov 1347: This post completes extension 3, as well as parts of extension 1 and 2_